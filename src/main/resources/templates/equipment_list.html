<!DOCTYPE html>
<!-- 
設備一覧表示画面のHTMLテンプレート
このテンプレートは設備管理システムのメイン画面で、登録されている全設備の一覧を表示します。
主な機能：
- 設備の基本情報表示
- 減価償却計算結果の表示
- 設備の状態による行の色分け
- 新規登録への遷移
- 個別編集機能
-->
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <title>設備一覧</title>
    <style>
        /* テーブルの基本スタイル */
        table {
            border-collapse: collapse;
            width: 100%;
        }

        /* テーブルのセルスタイル */
        th,
        td {
            border: 1px solid #999;
            padding: 8px;
            text-align: left;
        }

        /* テーブルヘッダーのスタイル */
        th {
            background-color: #eee;
        }

        /* アクションボタンのコンテナ */
        .action-buttons form {
            display: inline-block;
            margin: 0 4px;
        }

        /* 〇マーク（貸出可能・使用不能フラグ）のスタイル */
        .circle {
            font-weight: bold;
            color: green;
            text-align: center;
        }

        /* 上部ボタン用のコンテナスタイル */
        .top-buttons {
            text-align: right;
            margin: 10px 0;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* ボタンの共通スタイル */
        .action-button {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: background-color 0.2s;
        }

        /* 新規登録ボタンのスタイル（緑色） */
        .register-button {
            background-color: #4CAF50;
            color: white;
        }

        .register-button:hover {
            background-color: #45a049;
        }

        /* 編集ボタンのスタイル（青色） */
        .edit-button {
            background-color: #2196F3;
            color: white;
        }

        .edit-button:hover {
            background-color: #0b7dda;
        }

        /* 減価償却完了設備の行スタイル（青系背景） */
        .depreciation-completed {
            background-color: #e3f2fd !important;
        }

        /* 破損設備の行スタイル（グレーアウト） */
        .broken-equipment {
            background-color: #f5f5f5 !important;
            color: #888 !important;
            opacity: 0.7;
        }

        .broken-equipment td {
            background-color: #f5f5f5 !important;
            color: #888 !important;
        }

        /* 減価償却完了セルの特別スタイル（強調表示） */
        .depreciation-completed-cell {
            background-color: #2196f3 !important;
            color: white !important;
            font-weight: bold;
            text-align: center;
        }

        /* グレーアウト時でも〇マークは見やすく */
        .broken-equipment .circle {
            color: #666 !important;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <!-- ページタイトル -->
    <h1>設備一覧</h1>

    <!-- 上部操作ボタン群 -->
    <div class="top-buttons">
        <!-- 新規登録ボタン -->
        <a th:href="@{/equipment/create-form}">
            <button type="button" class="action-button register-button">(＋) 新規登録</button>
        </a>
    </div>

    <!-- 設備一覧テーブル -->
    <table>
        <!-- テーブルヘッダー -->
        <thead>
            <tr>
                <th>カテゴリー</th>
                <th>品目</th>
                <th>設備名</th>
                <th>型番</th>
                <th>メーカー</th>
                <th>仕様</th>
                <th>購入価格</th>
                <th>購入日</th>
                <th>設置場所</th>
                <th>耐用年数</th>
                <th>経過年数</th>
                <th>年間減価償却額</th>
                <th>帳簿価額</th>
                <th>減価償却状況</th>
                <th>編集</th>
            </tr>
        </thead>
        <!-- テーブル本体 -->
        <tbody>
            <tr th:each="equipment : ${equipments}"
                th:class="${equipment.isBroken} ? 'broken-equipment' : (${equipment.depreciationStatus == '終了'} ? 'depreciation-completed' : '')">
                <!-- カテゴリー -->
                <td th:text="${equipment.categoryName}"></td>
                <!-- 品目 -->
                <td th:text="${equipment.subcategoryName}"></td>
                <!-- 設備名 -->
                <td th:text="${equipment.name}"></td>
                <!-- 型番 -->
                <td th:text="${equipment.modelNumber ?: '-'}"></td>
                <!-- メーカー -->
                <td th:text="${equipment.manufacturer ?: '-'}"></td>
                <!-- 仕様 -->
                <td th:text="${equipment.specification ?: '-'}"></td>
                <!-- 購入価格 -->
                <td th:text="${#numbers.formatDecimal(equipment.cost, 1, 'COMMA', 0, 'POINT')}"></td>
                <!-- 購入日 -->
                <td th:text="${equipment.purchaseDate != null ? #temporals.format(equipment.purchaseDate, 'yyyy/MM/dd') : '-'}"></td>
                <!-- 設置場所 -->
                <td th:text="${equipment.locationLabel}"></td>
                <!-- 耐用年数 -->
                <td th:text="${equipment.lifespanYears > 0 ? equipment.lifespanYears + '年' : '-'}"></td>
                <!-- 経過年数 -->
                <td th:text="${equipment.elapsedYears != null ? equipment.elapsedYears + '年' : '-'}"></td>
                <!-- 年間減価償却額 -->
                <td th:text="${#numbers.formatDecimal(equipment.annualDepreciation, 1, 'COMMA', 0, 'POINT')}"></td>
                <!-- 帳簿価額 -->
                <td th:text="${#numbers.formatDecimal(equipment.bookValue, 1, 'COMMA', 0, 'POINT')}"></td>
                <!-- 減価償却状況 -->
                <td th:class="${equipment.depreciationStatus == '終了'} ? 'depreciation-completed-cell' : ''"
                    th:text="${equipment.depreciationStatus}"></td>
                <!-- 編集ボタン -->
                <td>
                    <a th:href="@{/equipment/edit(id=${equipment.id})}">
                        <button type="button" class="edit-button">編集</button>
                    </a>
                </td>
            </tr>
            <!-- 設備がない場合のメッセージ -->
            <tr th:if="${equipments.isEmpty()}">
                <td colspan="15" style="text-align: center;">表示する設備がありません。</td>
            </tr>
        </tbody>
    </table>
</body>

</html>